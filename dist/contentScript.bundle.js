(()=>{"use strict";const t="home",e="playlist",a="player",o="channel-index",n={[a]:"/watch",[e]:"/playlist",[o]:"/@",[t]:"/"},r={[a]:"#related",[t]:"#content",[o]:"#content",[e]:"#content"},s=t=>r[t],c="hideCounts",i=async(t,e)=>{const a=await(async t=>(await t.get(c))[c]||{})(t),o=a[e]||0,n={[c]:{...a,[e]:o+1}};await t.set(n)},l="settings",y="enabledLocations",w="statsEnabled",d=async()=>(await browser.storage.local.get(l))[l]||null,u=t=>t?.textContent?.trim();let f=null;const m=["ytd-rich-item-renderer","yt-lockup-view-model","ytd-playlist-video-renderer"],h=async r=>{if((t=>Array.from(t.querySelectorAll(".yt-badge-shape__text")).some(t=>t.textContent.toLowerCase().includes("Members only".toLowerCase())))(r)){const s=await(r=>{switch((()=>{for(const[t,e]of Object.entries(n))if(window.location.pathname.startsWith(e))return t;return null})()){case a:case t:{const t=r.querySelector("yt-content-metadata-view-model span.yt-content-metadata-view-model__metadata-text");return u(t)}case o:{const t=document.getElementById("page-header"),e=t?.querySelector(".dynamicTextViewModelH1 span.yt-core-attributed-string");return u(e)}case e:{const t=r.querySelector(".ytd-channel-name a");return u(t)}default:return null}})(r)||"Unknown";try{await(async t=>{browser.storage.local&&await(async t=>await i(browser.storage.local,t))(t),browser.storage.session&&await(async t=>await i(browser.storage.session,t))(t)})(s)}catch(t){console.error("Failed to increment hide count:",t)}r.remove()}},b=async t=>{for(const e of m){const a=t.matches(e)?[t]:t.querySelectorAll&&t.querySelectorAll(e);for(const t of a)await h(t)}},g=async t=>{for(const e of m)for(const a of t.querySelectorAll(e))await h(a)},p=async t=>{const e=Array.from(t.addedNodes).filter(t=>t.nodeType===Node.ELEMENT_NODE);for(const t of e)await b(t)},S=async t=>{for(const e of t)await p(e)};(async()=>{await(async()=>{await(async()=>{const n=await d();return(t=>!(!t||!Array.isArray(t[y])||!1!==t[w]&&!0!==t[w]))(n)?n:(await(async()=>{const n={[l]:{[y]:[a,e,o,t],[w]:!0}};return await(browser.storage?.local?.set(n)),n})(),await d())})(),await(async()=>{f?f.disconnect():f=new MutationObserver(S);const t=await(async()=>(await d())[y])();if(!t.length)return void console.warn("No locations to hide are enabled.");const e={childList:!0,subtree:!0};for(const a of t){const t=s(a),o=document.querySelector(t);o?(console.log(`Starting to watch location "${a}" for selector "${t}"`),await g(o),f.observe(o,e)):console.warn(`No container found for location "${a}"`)}})()})()})()})();