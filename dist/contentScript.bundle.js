(()=>{"use strict";const t={HOME:"home",PLAYLIST:"playlist",PLAYER:"player",CHANNEL_INDEX:"channel-index"},e={[t.PLAYER]:"/watch",[t.PLAYLIST]:"/playlist",[t.CHANNEL_INDEX]:"/@",[t.HOME]:"/"},a={[t.PLAYER]:"#related",[t.HOME]:"#content",[t.CHANNEL_INDEX]:"#content",[t.PLAYLIST]:"#content"},o=t=>a[t],n="hideCounts",r=async(t,e)=>{const a=await(async t=>(await t.get(n))[n]||{})(t),o=a[e]||0,r={[n]:{...a,[e]:o+1}};await t.set(r)},s="settings",c="enabledLocations",i="statsEnabled",l=async()=>(await browser.storage.local.get(s))[s]||null,y=async()=>{const e=await l();return(e=>{return e&&(e=>{if(!Array.isArray(e))return!1;for(const a of e)if(!Object.values(t).includes(a))return!1;return!0})(e[c])&&(!0===(a=e[i])||!1===a);var a})(e)?e:(await(async()=>{const e={[s]:{[c]:[t.PLAYER,t.PLAYLIST,t.CHANNEL_INDEX,t.HOME],[i]:!0}};return await(browser.storage?.local?.set(e)),e})(),await l())},w=t=>t?.textContent?.trim();let d=null;const u=["ytd-rich-item-renderer","yt-lockup-view-model","ytd-playlist-video-renderer"],f=async a=>{if((t=>Array.from(t.querySelectorAll(".yt-badge-shape__text")).some(t=>t.textContent.toLowerCase().includes("Members only".toLowerCase())))(a)){const o=await(a=>{switch((()=>{for(const[t,a]of Object.entries(e))if(window.location.pathname.startsWith(a))return t;return null})()){case t.PLAYER:case t.HOME:{const t=a.querySelector("yt-content-metadata-view-model span.yt-content-metadata-view-model__metadata-text");return w(t)}case t.CHANNEL_INDEX:{const t=document.getElementById("page-header"),e=t?.querySelector(".dynamicTextViewModelH1 span.yt-core-attributed-string");return w(e)}case t.PLAYLIST:{const t=a.querySelector(".ytd-channel-name a");return w(t)}default:return null}})(a)||"Unknown";try{await(async t=>{browser.storage.local&&await(async t=>await r(browser.storage.local,t))(t),browser.storage.session&&await(async t=>await r(browser.storage.session,t))(t)})(o)}catch(t){console.error("Failed to increment hide count:",t)}a.remove()}},E=async t=>{for(const e of u){const a=t.matches(e)?[t]:t.querySelectorAll&&t.querySelectorAll(e);for(const t of a)await f(t)}},L=async t=>{for(const e of u)for(const a of t.querySelectorAll(e))await f(a)},A=async t=>{const e=Array.from(t.addedNodes).filter(t=>t.nodeType===Node.ELEMENT_NODE);for(const t of e)await E(t)},m=async t=>{for(const e of t)await A(e)};(async()=>{await(async()=>{await y(),await(async()=>{d?d.disconnect():d=new MutationObserver(m);const t=await(async()=>(await l())[c])();if(!t.length)return void console.warn("No locations to hide are enabled.");const e={childList:!0,subtree:!0};for(const a of t){const t=o(a),n=document.querySelector(t);n?(console.log(`Starting to watch location "${a}" for selector "${t}"`),await L(n),d.observe(n,e)):console.warn(`No container found for location "${a}"`)}})()})()})()})();