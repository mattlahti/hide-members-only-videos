(()=>{"use strict";const e="home",t="playlist",o="player",a="channel-index",n={[o]:"/watch",[t]:"/playlist",[a]:"/@",[e]:"/"},r={[o]:"#related",[e]:"#content",[a]:"#content",[t]:"#content"},s=e=>r[e],c="hideCounts",l=async(e,t)=>{const o=await(async e=>(await e.get(c))[c]||{})(e),a=o[t]||0,n={[c]:{...o,[t]:a+1}};await e.set(n)},i=e=>e?.textContent?.trim(),y=["ytd-rich-item-renderer","yt-lockup-view-model","ytd-playlist-video-renderer"],d=async r=>{if((e=>Array.from(e.querySelectorAll(".yt-badge-shape__text")).some(e=>e.textContent.toLowerCase().includes("Members only".toLowerCase())))(r)){const s=await(r=>{switch((()=>{for(const[e,t]of Object.entries(n))if(window.location.pathname.startsWith(t))return e;return null})()){case o:case e:{const e=r.querySelector("yt-content-metadata-view-model span.yt-content-metadata-view-model__metadata-text");return i(e)}case a:{const e=document.getElementById("page-header"),t=e?.querySelector(".dynamicTextViewModelH1 span.yt-core-attributed-string");return i(t)}case t:{const e=r.querySelector(".ytd-channel-name a");return i(e)}default:return null}})(r)||"Unknown";try{await(async e=>{browser.storage.local&&await(async e=>await l(browser.storage.local,e))(e),browser.storage.session&&await(async e=>await l(browser.storage.session,e))(e)})(s)}catch(e){console.error("Failed to increment hide count:",e)}r.remove()}},w=async e=>{for(const t of y){const o=e.matches(t)?[e]:e.querySelectorAll&&e.querySelectorAll(t);for(const e of o)await d(e)}},u=async e=>{const t=Array.from(e.addedNodes).filter(e=>e.nodeType===Node.ELEMENT_NODE);for(const e of t)await w(e)},f=async e=>{for(const t of y)for(const o of e.querySelectorAll(t))await d(o)};(async()=>{await(async()=>{const n=[o,t,a,e];if(!n.length)return;const r=new MutationObserver(async e=>{for(const t of e)await u(t)}),c={childList:!0,subtree:!0};for(const e of n){const t=s(e),o=document.querySelector(t);o?(console.log(`Starting to watch location "${e}" for selector "${t}"`),await f(o),r.observe(o,c)):console.warn(`No container found for location "${e}"`)}})()})()})();